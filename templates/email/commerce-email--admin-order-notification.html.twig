{#
/**
 * @file
 * Admin notification template for new orders.
 *
 * Available variables:
 * - target_entity: The order entity.
 * - email: The email object.
 */
#}
<div style="font-family: Arial, sans-serif; max-width: 768px; margin: 0; padding: 20px; background: #f5f5f5;">

  {# Header #}
  <div style="background: #2c3e50; color: white; padding: 20px; border-radius: 5px 5px 0 0;">
    <h1 style="margin: 0; font-size: 24px;">üîî New Order Received</h1>
    <p style="margin: 5px 0 0 0; font-size: 14px; opacity: 0.9;">Administrative Notification</p>
  </div>

  {# Order Summary #}
  <div style="background: white; padding: 20px; border-radius: 0 0 5px 5px;">

    <h2 style="color: #2c3e50; border-bottom: 2px solid #3498db; padding-bottom: 10px;">
      Order Details
    </h2>

    <table style="width: 100%; margin: 20px 0;">
      <tr>
        <td style="padding: 8px; background: #ecf0f1; width: 30%;"><strong>Order ID:</strong></td>
        <td style="padding: 8px;">#{{ target_entity.id() }}</td>
      </tr>
      <tr>
        <td style="padding: 8px; background: #ecf0f1;"><strong>Order Number:</strong></td>
        <td style="padding: 8px;">{{ target_entity.getOrderNumber() }}</td>
      </tr>
      <tr>
        <td style="padding: 8px; background: #ecf0f1;"><strong>Customer:</strong></td>
        <td style="padding: 8px;">
          {{ target_entity.getCustomer().getDisplayName() }}
          <br>
          <small style="color: #666;">{{ target_entity.getEmail() }}</small>
        </td>
      </tr>
      <tr>
        <td style="padding: 8px; background: #ecf0f1;"><strong>Order Total:</strong></td>
        <td style="padding: 8px;">
          <strong style="color: #27ae60; font-size: 18px;">
            {{ target_entity.getTotalPrice()|commerce_price_format }}
          </strong>
        </td>
      </tr>
      <tr>
        <td style="padding: 8px; background: #ecf0f1;"><strong>Payment Status:</strong></td>
        <td style="padding: 8px;">
          {% if target_entity.hasField('payment_gateway') and not target_entity.get('payment_gateway').isEmpty() %}
            <span style="color: #27ae60; font-weight: bold;">‚úì Paid</span>
          {% else %}
            <span style="color: #e74c3c;">Pending</span>
          {% endif %}
        </td>
      </tr>
    </table>

    {# Order Items #}
    <h3 style="color: #2c3e50; margin-top: 30px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
      Order Items
    </h3>

    {% for item in target_entity.getItems() %}
      <div style="padding: 15px; margin: 10px 0; border: 1px solid #e0e0e0; border-radius: 5px; background: #fafafa;">
        <div style="margin-bottom: 5px;">
          <strong style="font-size: 16px;">
            {{ item.getQuantity()|number_format }} x {{ item.getTitle() }}
          </strong>
          <span style="float: right; font-size: 16px; color: #27ae60;">
            <strong>{{ item.getTotalPrice()|commerce_price_format }}</strong>
          </span>
          <div style="clear: both;"></div>
        </div>

        <div style="font-size: 13px; color: #666;">
          Unit price: {{ item.getUnitPrice()|commerce_price_format }}
        </div>

        {% if item.hasField('license') and not item.get('license').isEmpty() %}
          <div style="margin-top: 8px; padding: 8px; background: #e3f2fd; border-left: 3px solid #2196f3; border-radius: 3px;">
            <small style="color: #1976d2; font-weight: bold;">üì• Licensed Product</small>
          </div>
        {% endif %}
      </div>
    {% endfor %}

    {# Order Totals #}
    <div style="margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 5px;">
      <table>
        <tr style="border-top: 2px solid #333;">
          <td style="padding: 10px 5px;">
            <strong style="font-size: 18px;">Total:</strong>
            <strong style="font-size: 20px; color: #27ae60;">
              {{ target_entity.getTotalPrice()|commerce_price_format }}
            </strong>
          </td>
        </tr>
      </table>
    </div>

    {# Billing Information #}
    {% set billing_profile = target_entity.getBillingProfile() %}
    {% if billing_profile and billing_profile.hasField('address') and not billing_profile.get('address').isEmpty() %}
      <h3 style="color: #2c3e50; margin-top: 30px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
        Billing Information
      </h3>
      <div style="background: #ecf0f1; padding: 15px; border-radius: 5px; margin-top: 10px;">
        {% for address_item in billing_profile.get('address') %}
          {% if address_item.given_name or address_item.family_name %}
            <strong>{{ address_item.given_name }} {{ address_item.family_name }}</strong><br>
          {% endif %}
          {% if address_item.organization %}
            {{ address_item.organization }}<br>
          {% endif %}
          {% if address_item.address_line1 %}
            {{ address_item.address_line1 }}<br>
          {% endif %}
          {% if address_item.address_line2 %}
            {{ address_item.address_line2 }}<br>
          {% endif %}
          {% if address_item.locality or address_item.administrative_area or address_item.postal_code %}
            {{ address_item.locality }}{% if address_item.locality and address_item.administrative_area %}, {% endif %}{{ address_item.administrative_area }} {{ address_item.postal_code }}<br>
          {% endif %}
          {% if address_item.country_code %}
            {{ address_item.country_code }}
          {% endif %}
        {% endfor %}
      </div>
    {% endif %}

    {# Quick Admin Link #}
    <div style="margin-top: 30px; padding: 20px; background: #e8f5e9; border-left: 4px solid #4caf50; border-radius: 3px; text-align: center;">
      <h3 style="margin-top: 0; color: #2e7d32;">Quick Actions</h3>
      <p style="margin: 15px 0;">
        <a href="{{ url('<front>', {}, {'absolute': true}) }}admin/commerce/orders/{{ target_entity.id() }}"
           style="display: inline-block; padding: 12px 24px; background: #3498db; color: white; text-decoration: none; border-radius: 5px; font-weight: bold;">
          üëÅÔ∏è View Order in Admin
        </a>
      </p>
      <p style="margin: 10px 0; font-size: 12px; color: #666;">
        Direct link: {{ url('<front>', {}, {'absolute': true}) }}admin/commerce/orders/{{ target_entity.id() }}
      </p>
    </div>

    {# Customer Comments #}
    {% if target_entity.hasField('order_comments') and not target_entity.get('order_comments').isEmpty() %}
      <h3 style="color: #2c3e50; margin-top: 30px; border-bottom: 1px solid #ddd; padding-bottom: 10px;">
        Customer Comments
      </h3>
      <div style="background: #fff9c4; padding: 15px; border-left: 4px solid #ffc107; border-radius: 3px; margin-top: 10px;">
        {{ target_entity.get('order_comments').value|raw }}
      </div>
    {% endif %}

  </div>

  {# Footer #}
  <div style="text-align: center; margin-top: 20px; color: #7f8c8d; font-size: 12px;">
    <p style="margin: 5px 0;">Administrative notification from <strong>{{ target_entity.getStore().label() }}</strong></p>
    <p style="margin: 5px 0;">Do not reply to this email</p>
  </div>

</div>
